\RequirePackage[dvipdfmx]{graphicx}
%\RequirePackage[dvipdfmx]{color}
%\RequirePackage[dvipdfmx]{xcolor}

% ホントはgeometryで全部設定したかった
\RequirePackage[truedimen]{geometry}

\let\@coverstudentid\@empty
\let\@covertitle\@empty
\let\@covername\@empty
\let\@coveryear\@empty

\newcommand{\coverstudentid}[1]{\gdef\@coverstudentid{#1}}
\newcommand{\covertitle}[1]{\gdef\@covertitle{#1}}
\newcommand{\coveryear}[1]{\gdef\@coveryear{#1}}
\newcommand{\covername}[1]{\gdef\@covername{#1}}

\RequirePackage{setspace}
\RequirePackage{picture}
\newcommand{\makecover}{
  \thispagestyle{empty}
  \newgeometry{margin=0cm, bottom=0cm, top=0cm, footskip=0cm}
  \enlargethispage{\paperwidth}
  %\begin{minipage}[t]{\hsize}
  \begin{picture}(210truemm, 297truemm)%(0,0)
  
  % 学籍番号
  \normalsize\tt\mc
  \put(137truemm, 272.54truemm){
    \put( 0.00truemm,  0.00truemm){\makebox(0.00truemm, 0.00truemm){{\it No.}}}
    \put(-5.28truemm, -8.79truemm){\framebox(38.68truemm, 10.55truemm){\@coverstudentid}}
  }
  
  % 
  \normalsize\tt\mc
  \put(105.5truemm, 239.13truemm){\makebox(0.00truemm, 0.00truemm){卒\ 業\ 論\ 文}}
  
  % 慶應のペンマーク
  \normalsize\tt\mc
  \put(105.5truemm, 226.83truemm){\makebox(0.00truemm, 0.00truemm){
    \includegraphics[clip, scale=0.33]{images/keio.pdf}
  }}
  
  % title
  \put(105.5truemm, 201.86truemm){
    \large\tt\mc
    \put(-52.75truemm, -24.61truemm){\framebox(105.50truemm, 35.17truemm){}}
    \Huge\tt\mc
    \put(-54.51truemm, -26.38truemm){\framebox(109.02truemm, 38.68truemm){}} 
    % 論文題目
    \footnotesize\tt\mc
    \put(-42.20truemm,   7.03truemm){\makebox(0.00truemm, 0.00truemm){論文題目}}
    \large\tt\mc
    \put(  0.00truemm,  -7.03truemm){\makebox(0.00truemm, 0.00truemm){\parbox[c][3zw][c]{20zw}{\Large \begin{spacing}{0.8} \centering \@covertitle \end{spacing}}}}
  }
  
  % 指導教員
  \put(105.50truemm, 137.15truemm){
    \large\tt\mc
    \put(-45.72truemm, -14.07truemm){\framebox(91.43truemm, 28.13truemm)} 
    \put(  0.00truemm,   0.00truemm){\makebox(  0.00truemm,   0.00truemm){高\ 田\ 眞\ 吾}}
    \footnotesize\tt\mc
    \put(-35.17truemm,  11.25truemm){\makebox(  0.00truemm,   0.00truemm){指導教員}}
  }
  
  \normalsize\tt\mc
  \put(105.50truemm, 112.53truemm){\makebox(0.00truemm, 0.00truemm){慶\ 應\ 義\ 塾\ 大\ 学\ 理\ 工\ 学\ 部}}
  
  \put(105.50truemm, 98.47truemm){
    \normalsize\tt\mc
    \put(  0.00truemm,  0.00truemm){\makebox(0.00truemm, 0.00truemm){情\ 報\ 工\ 学\ 科}}
    \put(-35.17truemm, -3.52truemm){\line( 1, 0){70.33truemm}}
  }
  
  % 年度
  \put(105.50truemm, 73.85truemm){
    \large\tt\mc
    \put(-45.72truemm, -8.79truemm){\framebox(91.43truemm, 17.58truemm){\@coveryear}}
    \footnotesize\tt\mc
    \put(-38.68truemm,  5.98truemm){\makebox(  0.00truemm,  0.00truemm){年\ 度}}
  }
  
  % 氏名
  \put(105.50truemm, 38.68truemm){
    \large\tt\mc
    \put(-45.72truemm, -13.36truemm){\framebox(91.43truemm, 26.72truemm){\@covername}}
    \footnotesize\tt\mc
    \put(-38.68truemm,  10.55truemm){\makebox(  0.00truemm,  0.00truemm){氏\ 名}}
  }
  \end{picture}
  
  \restoregeometry
  \clearpage
}
